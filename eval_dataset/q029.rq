# category: "Performances"
# split: "medium"
# origin: competency_question
# question: "Give me the list of concerts given at the Philharmonie de Paris in which the orchestra is directed by the solo violin"
# query:
SELECT DISTINCT ?concert
WHERE {
  ?concert ecrm:P9_consists_of ?activityDir ;
      ecrm:P9_consists_of ?activityMus ;
      ecrm:P7_took_place_at <http://data.doremus.org/place/bd21be9c-3f2b-3aa3-a460-114d579eabe6> .

  ?activityDir ecrm:P14_carried_out_by ?conductor ;
    mus:U31_had_function <http://data.doremus.org/vocabulary/function/chief_conductor> .

  ?activityMus ecrm:P14_carried_out_by ?conductor ;
    mus:U1_used_medium_of_performance / skos:exactMatch* <http://www.mimo-db.eu/InstrumentsKeywords/3573> .
}

# workflow
build_query(question="Give me the list of concerts given at the Philharmonie de Paris in which the orchestra is directed by the solo violin", template="performance")
apply_filter(query_id=query_id, base_variable="performance", template="performance", filters={"location": "Philharmonie de Paris"})
add_triplet(subject="performance", subject_class="efrbroo:F31_Performance", property="ecrm:P9_consists_of+", obj="activityDir", obj_class="ecrm:E7_Activity", query_id=query_id)
add_triplet(subject="activityDir", subject_class="ecrm:E7_Activity", property="ecrm:P14_carried_out_by", obj="conductor", obj_class="ecrm:E21_Person", query_id=query_id)
add_triplet(subject="activityDir", subject_class="ecrm:E7_Activity", property="mus:U31_had_function", obj="chiefConductor", obj_class="skos:Concept", query_id=query_id)
add_triplet(subject="performance", subject_class="efrbroo:F31_Performance", property="ecrm:P9_consists_of+", obj="activityMus", obj_class="ecrm:E7_Activity", query_id=query_id)
add_triplet(subject="activityMus", subject_class="ecrm:E7_Activity", property="ecrm:P14_carried_out_by", obj="conductor", obj_class="ecrm:E21_Person", query_id=query_id)
add_triplet(subject="activityMus", subject_class="ecrm:E7_Activity", property="mus:U1_used_medium_of_performance", obj="violin", obj_class="skos:Concept", query_id=query_id)
execute_query(query_id=query_id)