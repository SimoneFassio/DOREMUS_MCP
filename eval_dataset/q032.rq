# category: "Recordings"
# split: "hard"
# origin: competency_question
# question: "Give me the artists that have been recorded more than 5 times by Radio France"
# query:
SELECT DISTINCT ?artist SAMPLE(?artistName) as ?name COUNT(DISTINCT ?rec) as ?recording_num
WHERE {
 ?rec  a efrbroo:F29_Recording_Event ;
       ecrm:P9_consists_of / ecrm:P14_carried_out_by <http://data.doremus.org/organization/Radio_France> ;
       efrbroo:R20_recorded ?performance .

 ?performance ecrm:P9_consists_of /  ecrm:P14_carried_out_by ?artist .

 ?artist foaf:name ?artistName
} GROUP BY ?artist
HAVING (COUNT(DISTINCT ?rec) > 5)

# workflow
build_query(question="Give me the artists that have been recorded more than 5 times by Radio France", template="recordingEvent")
apply_filter(query_id=query_id, base_variable="recordingEvent", template="recording_event", filters={"performed_by": ""})
apply_filter(query_id=query_id, base_variable="recordingEvent", template="recording_event", filters={"recorded_by": "Radio France"})
groupBy_having(subject="artist", obj="recordingEvent", function="COUNT", logic_type="more", valueStart="5", query_id=query_id)
execute_query(query_id=query_id)